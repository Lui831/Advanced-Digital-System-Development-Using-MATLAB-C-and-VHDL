%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                          %
%          Generated by MATLAB 25.2 and Fixed-Point Designer 25.2          %
%                                                                          %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%#codegen
function [y,dydx,d2ydx2,y0,y1] = prediction_v2_fixpt(x,w0,b0,w1,b1)
    % x é vetor de tamanho Nx1
    % w0, b0, w1 são vetores de tamanho Nn
    fm = get_fimath();

    Nn = fi(length(w0), 0, 4, 0, fm);
    N = fi(length(x), 0, 5, 0, fm);

    y = fi(zeros(1,fi_toint(N)), 1, 14, 17, fm);
    dydx = fi(zeros(1,fi_toint(N)), 1, 14, 14, fm);
    d2ydx2 = fi(zeros(1,fi_toint(N)), 1, 14, 12, fm);

    for j = fi(1, 0, 1, 0, fm):N
        yj = fi(0, 1, 14, 12, fm);
        dyj = fi(0, 1, 14, 13, fm);
        d2yj = fi(0, 1, 14, 11, fm);
        for i = fi(1, 0, 1, 0, fm):Nn
            z = fi(call_custom_fcn(w0(i)*x(j) + b0(i)), 0, 14, 13, fm);
            szp = fi(z * (fi(1, 0, 1, 0, fm) - z), 0, 14, 16, fm);
            szpp = fi(szp * (fi_signed(fi(1, 0, 1, 0, fm)) - fi(2, 0, 2, 0, fm) * call_custom_fcn(w0(i)*x(j) + b0(i))), 1, 14, 16, fm);

            yj(:) = yj + w1(i) * z;
            dyj(:) = dyj + w1(i) * w0(i) * szp;
            d2yj(:) = d2yj + w1(i) * w0(i)^2 * szpp;
        end
        y(j) = yj + b1;
        dydx(j) = dyj;
        d2ydx2(j) = d2yj;
    end

    % Cálculo de y(0) e y(1)
    y0 = fi(b1, 1, 14, 12, fm);
    y1 = fi(b1, 1, 14, 12, fm);
    for i = fi(1, 0, 1, 0, fm):Nn
        y0(:) = y0 + w1(i) * call_custom_fcn(b0(i));
        y1(:) = y1 + w1(i) * call_custom_fcn(w0(i) + b0(i));
    end
end

function y = call_custom_fcn(x)
      fm = get_fimath();

      y = fi(replacement_custom_fcn(x), 0, 14, 13, fm);
end

function y = custom_fcn(x)
  fm = get_fimath();

  [fmo_1,fmo_2] = size(x);
  L = fi(fmo_1, 0, 1, 0, fm);
  C = fi(fmo_2, 0, 1, 0, fm);
  % Initialize the output array
  y = fi(zeros(L, C), 0, 14, 13, fm);
   for i= 1:L
       for j=1:C
          y(i,j) = 1./(1+exp(-x(i,j)));
       end
   end   
end



function y = fi_signed(a)
    coder.inline( 'always' );
    if isfi( a ) && ~(issigned( a ))
        nt = numerictype( a );
        new_nt = numerictype( 1, nt.WordLength + 1, nt.FractionLength );
        y = fi( a, new_nt, fimath( a ) );
    else
        y = a;
    end
end


function y = fi_toint(u)
    coder.inline( 'always' );
    if isfi( u )
        nt = numerictype( u );
        s = nt.SignednessBool;
        wl = nt.WordLength;
        if s
            y = int32( fi( u, s, wl, 0, hdlfimath ) );
        else
            y = uint32( fi( u, s, wl, 0, hdlfimath ) );
        end
    else
        y = int32( u );
    end
end

%
% Copyright 2025 The MathWorks, Inc.

% calculate replacement_custom_fcn via lookup table between extents x = fi([-4.4348,11.4571]),
% interpolation degree  = 1, number of points = 1000
function y = replacement_custom_fcn( x )
    persistent LUT
    if ( isempty(LUT) )
        LUT = fi([0.0117184859472312, 0.0119041551308056, 0.0120927300847667, ...
	0.0122842551360396, 0.0124787752510715, 0.0126763360438801, ...
	0.0128769837841639, 0.0130807654054741, 0.0132877285134468, ...
	0.0134979213940941, 0.0137113930221542, 0.0139281930694974, ...
	0.0141483719135887, 0.0143719806460034, 0.0145990710809967, ...
	0.0148296957641236, 0.015063907980909, 0.0153017617655648, ...
	0.0155433119097538, 0.015788613971397, 0.0160377242835238, ...
	0.0162906999631607, 0.0165475989202593, 0.0168084798666584, ...
	0.0170734023250793, 0.0173424266381519, 0.0176156139774677, ...
	0.0178930263526578, 0.0181747266204931, 0.0184607784940027, ...
	0.0187512465516083, 0.0190461962462706, 0.0193456939146445, ...
	0.0196498067862395, 0.019958602992581, 0.0202721515763697, ...
	0.0205905225006335, 0.020913786657869, 0.0212420158791677, ...
	0.0215752829433214, 0.021913661585904, 0.0222572265083227, ...
	0.022606053386835, 0.0229602188815252, 0.0233198006452358, ...
	0.0236848773324465, 0.0240555286080977, 0.0244318351563488, ...
	0.0248138786892684, 0.0252017419554473, 0.0255955087485292, ...
	0.0259952639156508, 0.0264010933657859, 0.0268130840779836, ...
	0.0272313241094956, 0.0276559026037818, 0.0280869097983894, ...
	0.0285244370326936, 0.0289685767554937, 0.0294194225324548, ...
	0.0298770690533856, 0.0303416121393433, 0.0308131487495554, ...
	0.031291776988149, 0.0317775961106766, 0.0322707065304279, ...
	0.0327712098245172, 0.0332792087397347, 0.0337948071981496, ...
	0.0343181103024551, 0.0348492243410412, 0.0353882567927831, ...
	0.0359353163315338, 0.0364905128303065, 0.0370539573651336, ...
	0.0376257622185889, 0.0382060408829587, 0.0387949080630473, ...
	0.0393924796786027, 0.0399988728663459, 0.0406142059815907, ...
	0.0412385985994362, 0.0418721715155166, 0.042515046746292, ...
	0.0431673475288631, 0.0438291983202933, 0.0445007247964189, ...
	0.0451820538501323, 0.0458733135891172, 0.0465746333330193, ...
	0.0472861436100326, 0.0480079761528824, 0.0487402638941848, ...
	0.0494831409611648, 0.0502367426697091, 0.0510012055177377, ...
	0.0517766671778691, 0.0525632664893611, 0.0533611434493034, ...
	0.0541704392030424, 0.0549912960338137, 0.0558238573515625, ...
	0.056668267680927, 0.0575246726483637, 0.0583932189683897, ...
	0.0592740544289209, 0.0601673278756795, 0.0610731891956508, ...
	0.0619917892995611, 0.0629232801033562, 0.0638678145086536, ...
	0.0648255463821455, 0.065796630533927, 0.0667812226947256, ...
	0.0677794794920066, 0.0687915584249302, 0.0698176178381342, ...
	0.0708578168943198, 0.0719123155456125, 0.0729812745036767, ...
	0.0740648552085565, 0.07516321979622, 0.076276531064781, ...
	0.0774049524393765, 0.0785486479356723, 0.079707782121977, ...
	0.0808825200799373, 0.082073027363794, 0.0832794699581749, ...
	0.0845020142344021, 0.0857408269052927, 0.0869960749784309, ...
	0.0882679257078908, 0.08955654654439, 0.0908621050838544, ...
	0.0921847690143754, 0.0935247060615418, 0.0948820839321284, ...
	0.0962570702561267, 0.0976498325271003, 0.0990605380408523, ...
	0.100489353832391, 0.101936446611182, 0.103401982694675, ...
	0.104886127940095, 0.106389047674495, 0.107910906623056, ...
	0.10945186883563, 0.111012097611532, 0.112591755422562, ...
	0.11419100383427, 0.115810003425464, 0.117448913705952, ...
	0.119107893032542, 0.120787098523287, 0.122486685970004, ...
	0.124206809749057, 0.125947622730438, 0.127709276185146, ...
	0.12949191969089, 0.131295701036136, 0.133120766122517, ...
	0.134967258865635, 0.136835321094284, 0.13872509244812, ...
	0.140636710273818, 0.142570309519752, 0.144526022629226, ...
	0.146503979432317, 0.148504307036367, 0.15052712971516, ...
	0.152572568796865, 0.15464074255077, 0.156731766072883, ...
	0.158845751170461, 0.160982806245519, 0.163143036177405, ...
	0.165326542204504, 0.167533421805137, 0.169763768577758, ...
	0.172017672120501, 0.174295217910196, 0.176596487180906, ...
	0.178921556802114, 0.18127049915663, 0.183643382018327, ...
	0.186040268429817, 0.188461216580155, 0.190906279682702, ...
	0.193375505853238, 0.195868937988466, 0.198386613645005, ...
	0.200928564919005, 0.203494818326516, 0.206085394684718, ...
	0.208700308994175, 0.211339570322222, 0.214003181687626, ...
	0.216691139946681, 0.219403435680844, 0.222140053086097, ...
	0.224900969864142, 0.227686157115608, 0.230495579235399, ...
	0.233329193810352, 0.236186951519342, 0.239068796035995, ...
	0.241974663934172, 0.244904484596361, 0.247858180125153, ...
	0.250835665257941, 0.253836847285014, 0.25686162597119, ...
	0.25990989348115, 0.262981534308622, 0.266076425209578, ...
	0.269194435139585, 0.272335425195472, 0.275499248561442, ...
	0.278685750459809, 0.281894768106461, 0.285126130671227, ...
	0.288379659243263, 0.291655166801597, 0.294952458190969, ...
	0.298271330103075, 0.301611571063363, 0.304972961423467, ...
	0.308355273359414, 0.311758270875695, 0.315181709815311, ...
	0.318625337875877, 0.322088894631882, 0.325572111563173, ...
	0.329074712089754, 0.332596411612948, 0.336136917562999, ...
	0.339695929453144, 0.343273138940226, 0.346868229891853, ...
	0.350480878460154, 0.354110753162131, 0.357757514966636, ...
	0.361420817387953, 0.365100306585984, 0.368795621473027, ...
	0.372506393827109, 0.376232248411832, 0.379972803102706, ...
	0.383727669019881, 0.38749645066724, 0.39127874607776, ...
	0.395074146965053, 0.398882238881006, 0.402702601379399, ...
	0.406534808185384, 0.410378427370725, 0.414233021534624, ...
	0.418098147990027, 0.421973358955232, 0.425858201750652, ...
	0.429752219000551, 0.433654948839581, 0.437565925123929, ...
	0.441484677646881, 0.445410732358595, 0.449343611589876, ...
	0.453282834279738, 0.457227916206518, 0.461178370222319, ...
	0.465133706490552, 0.46909343272631, 0.473057054439357, ...
	0.477024075179456, 0.480993996783794, 0.484966319626228, ...
	0.488940542868112, 0.49291616471041, 0.496892682646846, ...
	0.500869593717819, 0.504846394764788, 0.508822582684896, ...
	0.512797654685508, 0.516771108538438, 0.520742442833551, ...
	0.5247111572315, 0.52867675271531, 0.53263873184054, ...
	0.536596598983771, 0.540549860589145, 0.544498025412696, ...
	0.548440604764233, 0.552377112746503, 0.556307066491408, ...
	0.560229986393018, 0.564145396337164, 0.568052823927368, ...
	0.571951800706895, 0.575841862376712, 0.579722549009145, ...
	0.58359340525703, 0.587453980558178, 0.591303829334956, ...
	0.595142511188815, 0.598969591089598, 0.602784639559471, ...
	0.606587232851321, 0.610376953121493, 0.614153388596721, ...
	0.617916133735145, 0.621664789381298, 0.625398962914954, ...
	0.629118268393756, 0.632822326689539, 0.636510765618273, ...
	0.640183220063559, 0.643839332093641, 0.647478751071866, ...
	0.651101133760592, 0.654706144418481, 0.658293454891198, ...
	0.661862744695484, 0.665413701096628, 0.668946019179333, ...
	0.672459401912007, 0.675953560204513, 0.679428212959405, ...
	0.682883087116707, 0.686317917692284, 0.68973244780987, ...
	0.693126428726823, 0.696499619853681, 0.699851788767607, ...
	0.703182711219809, 0.70649217113703, 0.709779960617227, ...
	0.713045879919515, 0.716289737448527, 0.719511349733275, ...
	0.722710541400665, 0.725887145143762, 0.729041001684969, ...
	0.732171959734233, 0.735279875942422, 0.738364614850018, ...
	0.741426048831276, 0.744464058033977, 0.747478530314947, ...
	0.750469361171481, 0.753436453668822, 0.75637971836386, ...
	0.759299073225195, 0.762194443549732, 0.765065761875946, ...
	0.767912967893991, 0.770736008352807, 0.773534836964364, ...
	0.776309414305222, 0.779059707715545, 0.781785691195731, ...
	0.784487345300802, 0.787164657032715, 0.78981761973074, ...
	0.792446232960043, 0.795050502398638, 0.797630439722829, ...
	0.800186062491305, 0.802717394028009, 0.805224463303931, ...
	0.807707304817944, 0.810165958476829, 0.812600469474599, ...
	0.81501088817127, 0.81739726997117, 0.819759675200938, ...
	0.822098168987299, 0.824412821134741, 0.826703706003209, ...
	0.828970902385899, 0.831214493387277, 0.833434566301407, ...
	0.83563121249069, 0.837804527265094, 0.839954609761982, ...
	0.8420815628266, 0.844185492893326, 0.84626650986774, ...
	0.848324727009598, 0.850360260816784, 0.852373230910297, ...
	0.854363759920339, 0.856331973373573, 0.858277999581599, ...
	0.860201969530698, 0.86210401677291, 0.863984277318478, ...
	0.865842889529709, 0.867679994016296, 0.869495733532129, ...
	0.87129025287364, 0.87306369877972, 0.87481621983321, ...
	0.876547966364035, 0.878259090353962, 0.879949745343042, ...
	0.881620086337727, 0.883270269720695, 0.884900453162389, ...
	0.886510795534291, 0.888101456823934, 0.889672598051662, ...
	0.891224381189143, 0.892756969079648, 0.89427052536008, ...
	0.895765214384774, 0.897241201151055, 0.898698651226547, ...
	0.900137730678243, 0.901558606003317, 0.902961444061676, ...
	0.904346412010245, 0.905713677238964, 0.907063407308507, ...
	0.908395769889683, 0.909710932704528, 0.911009063469063, ...
	0.912290329837705, 0.913554899349309, 0.914802939374831, ...
	0.91603461706659, 0.917250099309111, 0.918449552671531, ...
	0.919633143361532, 0.920801037180817, 0.921953399482058, ...
	0.923090395127338, 0.924212188448038, 0.925318943206152, ...
	0.92641082255702, 0.927487989013429, 0.928550604411084, ...
	0.929598829875414, 0.930632825789681, 0.931652751764385, ...
	0.932658766607924, 0.933651028298497, 0.934629693957213, ...
	0.935594919822391, 0.936546861225022, 0.937485672565373, ...
	0.938411507290695, 0.939324517874025, 0.940224855794053, ...
	0.941112671516026, 0.941988114473664, 0.942851333052072, ...
	0.943702474571613, 0.944541685272726, 0.945369110301665, ...
	0.946184893697125, 0.946989178377751, 0.947782106130488, ...
	0.948563817599758, 0.949334452277443, 0.950094148493649, ...
	0.950843043408227, 0.951581273003033, 0.952308972074908, ...
	0.953026274229345, 0.953733311874839, 0.954430216217888, ...
	0.955117117258624, 0.955794143787066, 0.956461423379964, ...
	0.957119082398217, 0.95776724598485, 0.958406038063531, ...
	0.95903558133761, 0.959655997289651, 0.960267406181465, ...
	0.960869927054599, 0.961463677731284, 0.962048774815813, ...
	0.962625333696346, 0.96319346854711, 0.963753292330997, ...
	0.964304916802529, 0.964848452511182, 0.965384008805064, ...
	0.965911693834909, 0.966431614558403, 0.966943876744803, ...
	0.967448584979856, 0.967945842670989, 0.968435752052767, ...
	0.968918414192611, 0.969393928996749, 0.969862395216406, ...
	0.970323910454211, 0.970778571170809, 0.971226472691682, ...
	0.971667709214145, 0.972102373814535, 0.972530558455555, ...
	0.972952353993789, 0.97336785018736, 0.973777135703735, ...
	0.974180298127655, 0.974577423969201, 0.974968598671967, ...
	0.975353906621346, 0.97573343115292, 0.976107254560936, ...
	0.976475458106874, 0.9768381220281, 0.977195325546581, ...
	0.977547146877673, 0.977893663238975, 0.978234950859223, ...
	0.97857108498725, 0.978902139900977, 0.979228188916443, ...
	0.979549304396878, 0.979865557761786, 0.980177019496068, ...
	0.980483759159152, 0.980785845394139, 0.981083345936961, ...
	0.981376327625539, 0.981664856408946, 0.981948997356567, ...
	0.982228814667248, 0.982504371678438, 0.982775730875319, ...
	0.983042953899913, 0.983306101560179, 0.983565233839073, ...
	0.983820409903595, 0.984071688113801, 0.984319126031781, ...
	0.984562780430611, 0.984802707303259, 0.985038961871464, ...
	0.98527159859456, 0.98550067117827, 0.985726232583448, ...
	0.985948335034775, 0.986167030029407, 0.986382368345578, ...
	0.986594400051138, 0.986803174512052, 0.987008740400836, ...
	0.987211145704937, 0.987410437735061, 0.987606663133436, ...
	0.987799867882017, 0.987990097310635, 0.988177396105076, ...
	0.988361808315105, 0.98854337736242, 0.988722146048546, ...
	0.988898156562665, 0.989071450489373, 0.98924206881638, ...
	0.989410051942135, 0.989575439683391, 0.989738271282694, ...
	0.989898585415812, 0.990056420199089, 0.990211813196734, ...
	0.990364801428038, 0.990515421374523, 0.990663708987023, ...
	0.990809699692689, 0.990953428401934, 0.9910949295153, ...
	0.991234236930254, 0.991371384047926, 0.991506403779758, ...
	0.991639328554103, 0.991770190322736, 0.991899020567312, ...
	0.992025850305739, 0.992150710098493, 0.992273630054858, ...
	0.992394639839098, 0.992513768676559, 0.992631045359708, ...
	0.992746498254094, 0.992860155304249, 0.992972044039519, ...
	0.993082191579824, 0.993190624641358, 0.993297369542215, ...
	0.993402452207952, 0.993505898177087, 0.993607732606529, ...
	0.993707980276945, 0.993806665598059, 0.993903812613889, ...
	0.993999445007924, 0.994093586108228, 0.994186258892486, ...
	0.994277485992994, 0.994367289701575, 0.994455691974439, ...
	0.994542714436986, 0.994628378388542, 0.994712704807036, ...
	0.994795714353622, 0.994877427377234, 0.994957863919093, ...
	0.995037043717145, 0.99511498621045, 0.995191710543507, ...
	0.995267235570528, 0.995341579859658, 0.995414761697129, ...
	0.995486799091368, 0.995557709777052, 0.995627511219105, ...
	0.995696220616638, 0.995763854906844, 0.995830430768842, ...
	0.995895964627458, 0.995960472656967, 0.996023970784778, ...
	0.996086474695069, 0.996147999832378, 0.99620856140514, ...
	0.996268174389174, 0.99632685353113, 0.996384613351881, ...
	0.99644146814987, 0.996497432004414, 0.99655251877896, ...
	0.996606742124297, 0.996660115481718, 0.996712652086147, ...
	0.996764364969217, 0.996815266962301, 0.996865370699511, ...
	0.996914688620645, 0.996963232974097, 0.997011015819727, ...
	0.997058049031686, 0.997104344301206, 0.997149913139346, ...
	0.997194766879702, 0.997238916681077, 0.997282373530115, ...
	0.997325148243892, 0.997367251472476, 0.997408693701446, ...
	0.997449485254381, 0.997489636295301, 0.997529156831087, ...
	0.997568056713858, 0.997606345643313, 0.997644033169043, ...
	0.997681128692806, 0.997717641470775, 0.997753580615743, ...
	0.997788955099306, 0.997823773754009, 0.99785804527546, ...
	0.997891778224417, 0.99792498102884, 0.997957661985918, ...
	0.997989829264059, 0.998021490904858, 0.998052654825035, ...
	0.998083328818336, 0.998113520557419, 0.998143237595702, ...
	0.998172487369189, 0.998201277198264, 0.998229614289467, ...
	0.998257505737234, 0.998284958525617, 0.998311979529977, ...
	0.998338575518651, 0.998364753154595, 0.998390518997003, ...
	0.998415879502902, 0.99844084102872, 0.998465409831833, ...
	0.998489592072093, 0.998513393813324, 0.998536821024802, ...
	0.998559879582713, 0.998582575271586, 0.998604913785704, ...
	0.998626900730501, 0.998648541623924, 0.998669841897794, ...
	0.998690806899125, 0.998711441891442, 0.998731752056064, ...
	0.99875174249338, 0.998771418224097, 0.998790784190471, ...
	0.998809845257526, 0.998828606214242, 0.998847071774737, ...
	0.998865246579424, 0.998883135196155, 0.998900742121342, ...
	0.998918071781065, 0.998935128532164, 0.998951916663311, ...
	0.998968440396069, 0.99898470388593, 0.999000711223344, ...
	0.999016466434727, 0.999031973483457, 0.999047236270847, ...
	0.999062258637119, 0.999077044362346, 0.999091597167388, ...
	0.999105920714815, 0.999120018609813, 0.999133894401074, ...
	0.999147551581678, 0.999160993589956, 0.999174223810344, ...
	0.999187245574221, 0.999200062160737, 0.999212676797623, ...
	0.999225092661997, 0.999237312881145, 0.999249340533309, ...
	0.999261178648438, 0.999272830208955, 0.999284298150484, ...
	0.999295585362592, 0.999306694689502, 0.999317628930798, ...
	0.999328390842127, 0.999338983135883, 0.99934940848188, ...
	0.99935966950802, 0.999369768800944, 0.999379708906681, ...
	0.999389492331278, 0.999399121541429, 0.999408598965085, ...
	0.999417926992064, 0.999427107974644, 0.999436144228154, ...
	0.999445038031545, 0.999453791627966, 0.99946240722532, ...
	0.999470886996815, 0.99947923308151, 0.999487447584846, ...
	0.999495532579174, 0.999503490104274, 0.99951132216786, ...
	0.999519030746088, 0.999526617784048, 0.999534085196247, ...
	0.999541434867094, 0.999548668651367, 0.99955578837468, ...
	0.999562795833936, 0.999569692797782, 0.999576481007047, ...
	0.999583162175183, 0.99958973798869, 0.999596210107538, ...
	0.999602580165589, 0.999608849770998, 0.999615020506624, ...
	0.999621093930419, 0.999627071575826, 0.99963295495216, ...
	0.999638745544984, 0.999644444816487, 0.999650054205847, ...
	0.999655575129592, 0.999661008981958, 0.999666357135238, ...
	0.999671620940125, 0.999676801726051, 0.999681900801523, ...
	0.99968691945445, 0.999691858952466, 0.99969672054325, ...
	0.999701505454838, 0.999706214895932, 0.999710850056202, ...
	0.99971541210659, 0.999719902199597, 0.999724321469578, ...
	0.999728671033025, 0.99973295198885, 0.999737165418658, ...
	0.999741312387019, 0.99974539394174, 0.999749411114122, ...
	0.999753364919227, 0.999757256356126, 0.999761086408156, ...
	0.999764856043163, 0.999768566213747, 0.999772217857506, ...
	0.999775811897263, 0.999779349241308, 0.999782830783619, ...
	0.99978625740409, 0.999789629968755, 0.999792949330001, ...
	0.999796216326785, 0.999799431784849, 0.999802596516919, ...
	0.999805711322919, 0.999808776990167, 0.999811794293575, ...
	0.999814763995844, 0.999817686847655, 0.999820563587862, ...
	0.999823394943671, 0.999826181630832, 0.999828924353813, ...
	0.999831623805978, 0.999834280669766, 0.999836895616858, ...
	0.99983946930835, 0.999842002394918, 0.999844495516981, ...
	0.999846949304864, 0.999849364378958, 0.999851741349873, ...
	0.999854080818595, 0.999856383376635, 0.999858649606182, ...
	0.999860880080246, 0.999863075362804, 0.999865236008942, ...
	0.999867362564996, 0.999869455568687, 0.999871515549262, ...
	0.999873543027621, 0.999875538516452, 0.999877502520363, ...
	0.999879435536002, 0.999881338052188, 0.999883210550035, ...
	0.999885053503068, 0.999886867377348, 0.999888652631587, ...
	0.999890409717263, 0.999892139078736, 0.999893841153359, ...
	0.99989551637159, 0.999897165157096, 0.999898787926866, ...
	0.999900385091314, 0.999901957054379, 0.999903504213632, ...
	0.999905026960376, 0.99990652567974, 0.999908000750782, ...
	0.99990945254658, 0.999910881434331, 0.999912287775439, ...
	0.999913671925608, 0.999915034234936, 0.999916375047994, ...
	0.999917694703923, 0.999918993536513, 0.999920271874292, ...
	0.999921530040603, 0.999922768353691, 0.999923987126783, ...
	0.999925186668164, 0.999926367281257, 0.999927529264699, ...
	0.999928672912417, 0.999929798513702, 0.999930906353282, ...
	0.999931996711393, 0.999933069863852, 0.999934126082126, ...
	0.999935165633397, 0.999936188780636, 0.999937195782664, ...
	0.99993818689422, 0.999939162366025, 0.999940122444844, ...
	0.999941067373549, 0.999941997391185, 0.99994291273302, ...
	0.999943813630616, 0.999944700311878, 0.99994557300112, ...
	0.999946431919113, 0.99994727728315, 0.999948109307091, ...
	0.999948928201427, 0.999949734173326, 0.999950527426687, ...
	0.999951308162196, 0.999952076577368, 0.999952832866606, ...
	0.999953577221244, 0.999954309829599, 0.999955030877016, ...
	0.999955740545917, 0.999956439015844, 0.999957126463508, ...
	0.999957803062833, 0.999958468984998, 0.99995912439848, ...
	0.999959769469101, 0.999960404360064, 0.999961029231998, ...
	0.999961644242999, 0.999962249548669, 0.999962845302151, ...
	0.999963431654177, 0.999964008753098, 0.999964576744925, ...
	0.999965135773365, 0.999965685979859, 0.999966227503613, ...
	0.999966760481642, 0.999967285048794, 0.999967801337793, ...
	0.999968309479266, 0.999968809601783, 0.99996930183188, ...
	0.999969786294102, 0.999970263111025, 0.999970732403292, ...
	0.999971194289644, 0.999971648886947, 0.999972096310223, ...
	0.999972536672679, 0.999972970085737, 0.999973396659061, ...
	0.999973816500582, 0.99997422971653, 0.99997463641146, ...
	0.999975036688276, 0.999975430648256, 0.999975818391085, ...
	0.99997620001487, 0.999976575616173, 0.999976945290032, ...
	0.999977309129985, 0.999977667228093, 0.999978019674967, ...
	0.999978366559785, 0.99997870797032, 0.99997904399296, ...
	0.999979374712729, 0.99997970021331, 0.999980020577065, ...
	0.999980335885057, 0.999980646217069, 0.999980951651625, ...
	0.999981252266012, 0.999981548136295, 0.99998183933734, ...
	0.999982125942831, 0.99998240802529, 0.999982685656094, ...
	0.999982958905493, 0.999983227842631, 0.999983492535559, ...
	0.999983753051254, 0.999984009455636, 0.999984261813586, ...
	0.999984510188961, 0.99998475464461, 0.999984995242389, ...
	0.99998523204318, 0.999985465106903, 0.999985694492532, ...
	0.999985920258113, 0.999986142460773, 0.999986361156738, ...
	0.999986576401349, 0.999986788249072, 0.999986996753512, ...
	0.999987201967431, 0.999987403942758, 0.9999876027306, ...
	0.99998779838126, 0.999987990944247, 0.999988180468287, ...
	0.999988367001339, 0.999988550590604, 0.999988731282539, ...
	0.999988909122867, 0.999989084156591, 0.999989256428001, ...
	0.999989425980691, ], ...
                 numerictype(false, 14, 13), ...
                 fimath(x));
    end
    x_idx = fi((x - -4.4348)*62.8622128254022,1,16,5,fimath(x));
       idx_bot =  floor(x_idx) + 1;
       x_idx(:) = x_idx  + 1; 
       if ( idx_bot >= fi(1000,numerictype(idx_bot),fimath(x)) )
           idx_bot = fi((999),numerictype(idx_bot),fimath(x));
       elseif ( idx_bot < fi(1,numerictype(idx_bot),fimath(x)) )
           idx_bot = fi(1,numerictype(idx_bot),fimath(x));
       end
       idx_top = fi(idx_bot+1,numerictype(idx_bot),fimath(x));
       x_bot = idx_bot;
       x_top = idx_top;

       y_bot = LUT(idx_bot);
       y_top = LUT(idx_top);
        y = y_top*(x_idx-x_bot) + ...
            y_bot*(x_top - x_idx);
end

function fm = get_fimath()
	fm = fimath('RoundingMethod', 'Floor',...
	     'OverflowAction', 'Wrap',...
	     'ProductMode','FullPrecision',...
	     'MaxProductWordLength', 128,...
	     'SumMode','FullPrecision',...
	     'MaxSumWordLength', 128);
end
