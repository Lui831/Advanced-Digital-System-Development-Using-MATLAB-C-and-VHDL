%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                          %
%          Generated by MATLAB 25.2 and Fixed-Point Designer 25.2          %
%                                                                          %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%#codegen
function [y,dydx,d2ydx2,y0,y1] = prediction_v2_fixpt(x,w0,b0,w1,b1)
    % x é vetor de tamanho Nx1
    % w0, b0, w1 são vetores de tamanho Nn
    fm = get_fimath();

    Nn = fi(length(w0), 0, 4, 0, fm);
    N = fi(length(x), 0, 5, 0, fm);

    y = fi(zeros(1,fi_toint(N)), 1, 14, 17, fm);
    dydx = fi(zeros(1,fi_toint(N)), 1, 14, 14, fm);
    d2ydx2 = fi(zeros(1,fi_toint(N)), 1, 14, 11, fm);

    for j = fi(1, 0, 1, 0, fm):N
        yj = fi(0, 1, 14, 12, fm);
        dyj = fi(0, 1, 14, 13, fm);
        d2yj = fi(0, 1, 14, 11, fm);
        for i = fi(1, 0, 1, 0, fm):Nn
            z = fi(call_custom_fcn(w0(i)*x(j) + b0(i)), 0, 14, 13, fm);
            szp = fi(z * (fi(1, 0, 1, 0, fm) - z), 0, 14, 16, fm);
            szpp = fi(szp * (fi_signed(fi(1, 0, 1, 0, fm)) - fi(2, 0, 2, 0, fm) * call_custom_fcn(w0(i)*x(j) + b0(i))), 1, 14, 16, fm);

            yj(:) = yj + w1(i) * z;
            dyj(:) = dyj + w1(i) * w0(i) * szp;
            d2yj(:) = d2yj + w1(i) * w0(i)^2 * szpp;
        end
        y(j) = yj + b1;
        dydx(j) = dyj;
        d2ydx2(j) = d2yj;
    end

    % Cálculo de y(0) e y(1)
    y0 = fi(b1, 1, 14, 12, fm);
    y1 = fi(b1, 1, 14, 12, fm);
    for i = fi(1, 0, 1, 0, fm):Nn
        y0(:) = y0 + w1(i) * call_custom_fcn(b0(i));
        y1(:) = y1 + w1(i) * call_custom_fcn(w0(i) + b0(i));
    end
end

function y = call_custom_fcn(x)
      fm = get_fimath();

      y = fi(replacement_custom_fcn(x), 0, 14, 13, fm);
end

function y = custom_fcn(x)
  fm = get_fimath();

  [fmo_1,fmo_2] = size(x);
  L = fi(fmo_1, 0, 1, 0, fm);
  C = fi(fmo_2, 0, 1, 0, fm);
  % Initialize the output array
  y = fi(zeros(L, C), 0, 14, 13, fm);
   for i= 1:L
       for j=1:C
          y(i,j) = 1/(1+exp(-x(i,j)));
       end
   end   
end



function y = fi_signed(a)
    coder.inline( 'always' );
    if isfi( a ) && ~(issigned( a ))
        nt = numerictype( a );
        new_nt = numerictype( 1, nt.WordLength + 1, nt.FractionLength );
        y = fi( a, new_nt, fimath( a ) );
    else
        y = a;
    end
end


function y = fi_toint(u)
    coder.inline( 'always' );
    if isfi( u )
        nt = numerictype( u );
        s = nt.SignednessBool;
        wl = nt.WordLength;
        if s
            y = int32( fi( u, s, wl, 0, hdlfimath ) );
        else
            y = uint32( fi( u, s, wl, 0, hdlfimath ) );
        end
    else
        y = int32( u );
    end
end

%
% Copyright 2025 The MathWorks, Inc.

% calculate replacement_custom_fcn via lookup table between extents x = fi([-4.4348,12.6798529766522]),
% interpolation degree  = 1, number of points = 1000
function y = replacement_custom_fcn( x )
    persistent LUT
    if ( isempty(LUT) )
        LUT = fi([0.0117184859472312, 0.0119185606982464, 0.0121220095122193, ...
	0.0123288878471923, 0.0125392520231207, 0.0127531592335488, ...
	0.0129706675573834, 0.0131918359707621, 0.0134167243590151, ...
	0.0136453935287187, 0.0138779052198393, 0.0141143221179632, ...
	0.0143547078666134, 0.0145991270796482, 0.0148476453537406, ...
	0.0151003292809342, 0.0153572464612752, 0.0156184655155145, ...
	0.0158840560978792, 0.0161540889089077, 0.016428635708347, ...
	0.016707769328107, 0.016991563685268, 0.0172800937951379, ...
	0.017573435784353, 0.0178716669040202, 0.0181748655428931, ...
	0.0184831112405788, 0.0187964847007697, 0.0191150678044932, ...
	0.0194389436233754, 0.0197681964329123, 0.0201029117257401, ...
	0.0204431762249014, 0.0207890778970964, 0.0211407059659159, ...
	0.0214981509250448, 0.0218615045514305, 0.0222308599184076, ...
	0.0226063114087702, 0.0229879547277823, 0.0233758869161181, ...
	0.0237702063627224, 0.0241710128175809, 0.0245784074043896, ...
	0.024992492633114, 0.0254133724124262, 0.0258411520620075, ...
	0.0262759383247068, 0.0267178393785406, 0.0271669648485222, ...
	0.0276234258183084, 0.0280873348416476, 0.0285588059536174, ...
	0.0290379546816362, 0.0295248980562337, 0.030019754621565, ...
	0.0305226444456525, 0.0310336891303389, 0.0315530118209339, ...
	0.0320807372155383, 0.0326169915740256, 0.0331619027266642, ...
	0.0337156000823605, 0.0342782146365022, 0.0348498789783833, ...
	0.0354307272981891, 0.036020895393519, 0.0366205206754268, ...
	0.0372297421739542, 0.0378487005431364, 0.0384775380654532, ...
	0.039116398655704, 0.0397654278642802, 0.0404247728798096, ...
	0.0410945825311467, 0.041775007288682, 0.042466199264943, ...
	0.0431683122144588, 0.0438815015328587, 0.0446059242551774, ...
	0.0453417390533342, 0.0460891062327581, 0.0468481877281257, ...
	0.0476191470981818, 0.0484021495196076, 0.049197361779907, ...
	0.050004952269274, 0.050825090971409, 0.0516579494532487, ...
	0.0525037008535731, 0.0533625198704561, 0.0542345827475198, ...
	0.0551200672589592, 0.0560191526932963, 0.0569320198358279, ...
	0.0578588509497283, 0.0587998297557658, 0.0597551414105977, ...
	0.0607249724835993, 0.0617095109321907, 0.0627089460756187, ...
	0.0637234685671534, 0.0647532703646597, 0.0657985446994999, ...
	0.0668594860437293, 0.0679362900755396, 0.0690291536429118, ...
	0.0701382747254341, 0.0712638523942448, 0.0724060867700574, ...
	0.0735651789792276, 0.0747413311078193, 0.0759347461536294, ...
	0.0771456279761303, 0.0783741812442897, 0.0796206113822271, ...
	0.0808851245126682, 0.082167927398158, 0.0834692273799934, ...
	0.0847892323148402, 0.0861281505089943, 0.087486190650255, ...
	0.0888635617373732, 0.0902604730070418, 0.0916771338583966, ...
	0.0931137537749951, 0.094570542244246, 0.0960477086742591, ...
	0.0975454623080911, 0.0990640121353619, 0.100603566801219, ...
	0.102164334512628, 0.103746522941979, 0.105350339127974, ...
	0.106975989373807, 0.108623679142604, 0.110293612950129, ...
	0.111985994254735, 0.113701025344584, 0.115438907222099, ...
	0.117199839485692, 0.118984020208741, 0.120791645815851, ...
	0.122622910956397, 0.124478008375383, 0.126357128781622, ...
	0.12826046071328, 0.130188190400799, 0.132140501627252, ...
	0.134117575586151, 0.13611959073677, 0.138146722657016, ...
	0.140199143893917, 0.142277023811778, 0.14438052843807, ...
	0.146509820307124, 0.148665058301713, 0.150846397492579, ...
	0.153053988976032, 0.155287979709668, 0.157548512346341, ...
	0.159835725066477, 0.162149751408843, 0.164490720099887, ...
	0.166858754881777, 0.169253974339264, 0.171676491725504, ...
	0.174126414786987, 0.176603845587715, 0.179108880332784, ...
	0.181641609191533, 0.184202116120435, 0.186790478685881, ...
	0.189406767887066, 0.192051047979135, 0.194723376296806, ...
	0.197423803078641, 0.200152371292197, 0.202909116460242, ...
	0.20569406648826, 0.208507241493473, 0.211348653635587, ...
	0.214218306949506, 0.21711619718024, 0.220042311620258, ...
	0.222996628949504, 0.22597911907835, 0.22898974299372, ...
	0.23202845260864, 0.235095190615471, 0.238189890343079, ...
	0.241312475618214, 0.244462860631338, 0.247640949807186, ...
	0.250846637680306, 0.254079808775851, 0.257340337495878, ...
	0.260628088011422, 0.263942914160601, 0.267284659353004, ...
	0.270653156480636, 0.274048227835643, 0.277469685035095, ...
	0.280917328953045, 0.284390949660126, 0.287890326370897, ...
	0.291415227399181, 0.29496541012161, 0.298540620949584, ...
	0.302140595309857, 0.305765057633944, 0.309413721356529, ...
	0.313086288923057, 0.316782451806673, 0.320501890534668, ...
	0.324244274724562, 0.328009263129974, 0.331796503696377, ...
	0.335605633626858, 0.339436279457966, 0.343288057145721, ...
	0.347160572161861, 0.351053419600349, 0.354966184294193, ...
	0.358898440942584, 0.362849754248343, 0.366819679065672, ...
	0.370807760558165, 0.374813534367029, 0.378836526789436, ...
	0.38287625496694, 0.386932227083824, 0.391003942575281, ...
	0.395090892345269, 0.39919255899389, 0.403308417054117, ...
	0.407437933237677, 0.411580566689864, 0.415735769253079, ...
	0.419902985738836, 0.424081654207964, 0.428271206258757, ...
	0.432471067322746, 0.43668065696781, 0.44089938920828, ...
	0.445126672821729, 0.449361911672057, 0.453604505038549, ...
	0.457853847950498, 0.462109331527015, 0.466370343321644, ...
	0.470636267671343, 0.47490648604944, 0.479180377422116, ...
	0.483457318608009, 0.487736684640462, 0.492017849132011, ...
	0.496300184640617, 0.500583063037236, 0.504865855874225, ...
	0.509147934754156, 0.513428671698565, 0.51770743951618, ...
	0.521983612170162, 0.526256565143919, 0.530525675805019, ...
	0.534790323766766, 0.539049891246999, 0.543303763423653, ...
	0.547551328786679, 0.551791979485877, 0.556025111674238, ...
	0.560250125846386, 0.56446642717172, 0.568673425821887, ...
	0.572870537292185, 0.577057182716567, 0.581232789175873, ...
	0.585396789998979, 0.589548625056519, 0.5936877410469, ...
	0.5978135917743, 0.601925638418396, 0.606023349795547, ...
	0.610106202611203, 0.61417368170331, 0.618225280276514, ...
	0.622260500126961, 0.626278851857535, 0.630279855083374, ...
	0.634263038627525, 0.638227940706629, 0.642174109106525, ...
	0.646101101347694, 0.650008484840484, 0.653895837030058, ...
	0.657762745531033, 0.661608808251811, 0.665433633508586, ...
	0.669236840129059, 0.673018057545883, 0.676776925879911, ...
	0.680513096013277, 0.684226229652432, 0.687915999381191, ...
	0.691582088703926, 0.695224192079018, 0.69884201494269, ...
	0.702435273723393, 0.706003695846877, 0.709547019732134, ...
	0.713064994778378, 0.716557381343269, 0.720023950712554, ...
	0.723464485061365, 0.726878777407349, 0.730266631555888, ...
	0.733627862037617, 0.736962294038483, 0.740269763322572, ...
	0.743550116147975, 0.746803209175916, 0.750028909373403, ...
	0.75322709390967, 0.756397650046649, 0.759540475023744, ...
	0.762655475937169, 0.765742569614106, 0.768801682481949, ...
	0.771832750432898, 0.774835718684162, 0.777810541634037, ...
	0.780757182714106, 0.783675614237833, 0.786565817245798, ...
	0.789427781347826, 0.792261504562256, 0.7950669931526, ...
	0.797844261461833, 0.800593331744546, 0.803314233997206, ...
	0.806007005786735, 0.808671692077647, 0.811308345057952, ...
	0.813917023964048, 0.816497794904793, 0.819050730684981, ...
	0.821575910628399, 0.824073420400663, 0.826543351832023, ...
	0.828985802740293, 0.831400876754114, 0.833788683136678, ...
	0.836149336610094, 0.838482957180549, 0.840789669964397, ...
	0.843069605015329, 0.845322897152755, 0.847549685791522, ...
	0.849750114773091, 0.85192433219829, 0.854072490261753, ...
	0.856194745088143, 0.858291256570262, 0.860362188209133, ...
	0.862407706956149, 0.864427983057355, 0.866423189899947, ...
	0.868393503861064, 0.870339104158908, 0.872260172706288, ...
	0.874156893966605, 0.87602945481236, 0.877878044386195, ...
	0.879702853964531, 0.881504076823827, 0.883281908109485, ...
	0.885036544707439, 0.886768185118436, 0.888477029335035, ...
	0.890163278721333, 0.891827135895433, 0.893468804614651, ...
	0.895088489663476, 0.896686396744278, 0.898262732370751, ...
	0.899817703764107, 0.901351518751989, 0.902864385670105, ...
	0.904356513266565, 0.905828110608898, 0.907279386993746, ...
	0.908710551859195, 0.910121814699735, 0.911513384983811, ...
	0.912885472073954, 0.914238285149446, 0.915572033131504, ...
	0.916886924610942, 0.918183167778282, 0.919460970356282, ...
	0.920720539534844, 0.921962081908259, 0.923185803414773, ...
	0.924391909278406, 0.925580603953016, 0.926752091068545, ...
	0.92790657337942, 0.929044252715071, 0.930165329932511, ...
	0.931270004870952, 0.932358476308412, 0.933430941920263, ...
	0.934487598239688, 0.935528640620009, 0.936554263198823, ...
	0.937564658863932, 0.938560019221007, 0.939540534562946, ...
	0.940506393840896, 0.941457784636884, 0.942394893138021, ...
	0.943317904112246, 0.944227000885554, 0.945122365320686, ...
	0.946004177797223, 0.946872617193062, 0.947727860867222, ...
	0.948570084643944, 0.949399462798063, 0.950216168041584, ...
	0.951020371511452, 0.951812242758473, 0.952591949737337, ...
	0.953359658797728, 0.954115534676473, 0.954859740490693, ...
	0.955592437731941, 0.956313786261273, 0.957023944305225, ...
	0.957723068452684, 0.958411313652588, 0.95908883321245, ...
	0.959755778797672, 0.960412300431611, 0.961058546496374, ...
	0.961694663734317, 0.962320797250218, 0.962937090514091, ...
	0.963543685364627, 0.964140722013228, 0.964728339048613, ...
	0.965306673441967, 0.965875860552616, 0.966436034134201, ...
	0.966987326341329, 0.967529867736681, 0.968063787298549, ...
	0.968589212428794, 0.969106268961193, 0.969615081170161, ...
	0.970115771779826, 0.970608461973446, 0.971093271403138, ...
	0.971570318199914, 0.972039718983994, 0.972501588875398, ...
	0.972956041504777, 0.973403189024493, 0.973843142119912, ...
	0.974276010020909, 0.974701900513564, 0.975120919952043, ...
	0.975533173270636, 0.975938763995964, 0.976337794259311, ...
	0.976730364809101, 0.977116575023488, 0.97749652292305, ...
	0.97787030518359, 0.978238017149013, 0.978599752844294, ...
	0.9789556049885, 0.97930566500788, 0.979650023049, ...
	0.979988767991926, 0.980321987463433, 0.980649767850245, ...
	0.98097219431229, 0.98128935079597, 0.981601320047428, ...
	0.981908183625824, 0.98221002191659, 0.982506914144677, ...
	0.982798938387783, 0.983086171589549, 0.983368689572727, ...
	0.983646567052312, 0.983919877648631, 0.984188693900388, ...
	0.984453087277655, 0.984713128194815, 0.984968886023439, ...
	0.985220429105106, 0.985467824764155, 0.985711139320371, ...
	0.985950438101593, 0.986185785456251, 0.986417244765823, ...
	0.986644878457213, 0.986868748015044, 0.987088913993863, ...
	0.987305436030262, 0.987518372854907, 0.987727782304473, ...
	0.987933721333488, 0.98813624602608, 0.988335411607627, ...
	0.988531272456304, 0.988723882114541, 0.988913293300364, ...
	0.98909955791865, 0.989282727072263, 0.989462851073099, ...
	0.989639979453015, 0.98981416097466, 0.989985443642194, ...
	0.990153874711902, 0.9903195007027, 0.990482367406532, ...
	0.990642519898662, 0.99080000254785, 0.990954859026427, ...
	0.991107132320254, 0.991256864738577, 0.991404097923771, ...
	0.991548872860972, 0.991691229887606, 0.991831208702799, ...
	0.991968848376693, 0.992104187359638, 0.992237263491284, ...
	0.992368114009566, 0.992496775559577, 0.992623284202335, ...
	0.992747675423447, 0.992869984141662, 0.992990244717319, ...
	0.993108490960691, 0.993224756140227, 0.993339072990683, ...
	0.993451473721157, 0.993561990023015, 0.993670653077719, ...
	0.993777493564552, 0.993882541668244, 0.993985827086493, ...
	0.994087379037394, 0.994187226266763, 0.99428539705537, ...
	0.994381919226065, 0.994476820150819, 0.994570126757667, ...
	0.994661865537546, 0.994752062551059, 0.994840743435125, ...
	0.994927933409554, 0.995013657283524, 0.995097939461964, ...
	0.995180803951857, 0.995262274368448, 0.995342373941366, ...
	0.99542112552066, 0.995498551582749, 0.995574674236291, ...
	0.995649515227957, 0.99572309594814, 0.995795437436563, ...
	0.995866560387821, 0.995936485156831, 0.996005231764215, ...
	0.996072819901591, 0.9961392689368, 0.996204597919046, ...
	0.996268825583965, 0.99633197035862, 0.996394050366418, ...
	0.996455083431963, 0.996515087085823, 0.99657407856924, ...
	0.996632074838758, 0.996689092570794, 0.996745148166125, ...
	0.996800257754324, 0.996854437198115, 0.996907702097672, ...
	0.996960067794845, 0.997011549377331, 0.997062161682773, ...
	0.997111919302799, 0.997160836587001, 0.997208927646857, ...
	0.997256206359578, 0.997302686371915, 0.997348381103896, ...
	0.997393303752502, 0.997437467295301, 0.997480884494008, ...
	0.997523567898004, 0.997565529847794, 0.997606782478407, ...
	0.997647337722754, 0.997687207314925, 0.997726402793433, ...
	0.997764935504419, 0.997802816604791, 0.997840057065327, ...
	0.997876667673721, 0.997912659037583, 0.997948041587394, ...
	0.997982825579413, 0.998017021098536, 0.998050638061112, ...
	0.998083686217716, 0.99811617515587, 0.998148114302735, ...
	0.998179512927744, 0.998210380145203, 0.998240724916851, ...
	0.998270556054372, 0.998299882221876, 0.99832871193833, ...
	0.998357053579959, 0.998384915382606, 0.998412305444048, ...
	0.998439231726285, 0.998465702057786, 0.998491724135698, ...
	0.99851730552802, 0.99854245367575, 0.998567175894982, ...
	0.998591479378984, 0.998615371200232, 0.998638858312416, ...
	0.998661947552416, 0.998684645642236, 0.998706959190918, ...
	0.99872889469642, 0.998750458547461, 0.998771657025338, ...
	0.998792496305717, 0.99881298246039, 0.998833121459006, ...
	0.998852919170768, 0.998872381366116, 0.998891513718363, ...
	0.998910321805325, 0.998928811110905, 0.998946987026668, ...
	0.998964854853375, 0.998982419802506, 0.998999686997748, ...
	0.999016661476459, 0.999033348191117, 0.999049752010733, ...
	0.999065877722251, 0.999081730031917, 0.999097313566634, ...
	0.999112632875284, 0.999127692430038, 0.999142496627637, ...
	0.999157049790661, 0.999171356168765, 0.999185419939904, ...
	0.999199245211535, 0.999212836021797, 0.999226196340675, ...
	0.999239330071141, 0.999252241050281, 0.999264933050397, ...
	0.999277409780098, 0.999289674885364, 0.999301731950604, ...
	0.999313584499683, 0.999325235996944, 0.999336689848206, ...
	0.999347949401747, 0.999359017949272, 0.999369898726862, ...
	0.99938059491591, 0.999391109644042, 0.999401445986021, ...
	0.999411606964631, 0.999421595551561, 0.999431414668254, ...
	0.999441067186761, 0.999450555930568, 0.999459883675415, ...
	0.999469053150099, 0.999478067037264, 0.999486927974182, ...
	0.99949563855351, 0.99950420132405, 0.999512618791481, ...
	0.99952089341909, 0.999529027628485, 0.999537023800296, ...
	0.999544884274868, 0.999552611352939, 0.99956020729631, ...
	0.999567674328497, 0.999575014635381, 0.999582230365841, ...
	0.99958932363238, 0.999596296511736, 0.999603151045486, ...
	0.999609889240642, 0.999616513070231, 0.999623024473872, ...
	0.999629425358337, 0.999635717598106, 0.999641903035915, ...
	0.999647983483289, 0.999653960721069, 0.999659836499934, ...
	0.999665612540906, 0.999671290535853, 0.999676872147982, ...
	0.999682359012322, 0.999687752736202, 0.999693054899718, ...
	0.999698267056191, 0.999703390732624, 0.999708427430144, ...
	0.99971337862444, 0.999718245766193, 0.999723030281499, ...
	0.999727733572286, 0.999732357016718, 0.999736901969605, ...
	0.99974136976279, 0.999745761705541, 0.999750079084933, ...
	0.999754323166224, 0.999758495193222, 0.999762596388649, ...
	0.999766627954498, 0.999770591072385, 0.999774486903889, ...
	0.999778316590898, 0.999782081255937, 0.999785782002498, ...
	0.999789419915361, 0.999792996060913, 0.999796511487455, ...
	0.999799967225514, 0.999803364288139, 0.999806703671199, ...
	0.999809986353674, 0.999813213297941, 0.999816385450054, ...
	0.999819503740022, 0.999822569082079, 0.999825582374955, ...
	0.999828544502132, 0.999831456332108, 0.999834318718648, ...
	0.999837132501037, 0.999839898504319, 0.999842617539546, ...
	0.999845290404006, 0.999847917881467, 0.999850500742396, ...
	0.999853039744191, 0.9998555356314, 0.999857989135937, ...
	0.999860400977301, 0.999862771862782, 0.999865102487668, ...
	0.999867393535453, 0.999869645678031, 0.999871859575895, ...
	0.999874035878334, 0.999876175223615, 0.999878278239179, ...
	0.999880345541815, 0.999882377737849, 0.999884375423317, ...
	0.999886339184138, 0.999888269596292, 0.99989016722598, ...
	0.999892032629797, 0.999893866354891, 0.999895668939124, ...
	0.999897440911229, 0.999899182790968, 0.999900895089279, ...
	0.999902578308429, 0.999904232942161, 0.999905859475836, ...
	0.999907458386579, 0.999909030143416, 0.999910575207411, ...
	0.999912094031804, 0.99991358706214, 0.999915054736402, ...
	0.999916497485139, 0.999917915731591, 0.999919309891814, ...
	0.999920680374802, 0.999922027582606, 0.99992335191045, ...
	0.999924653746854, 0.999925933473736, 0.999927191466537, ...
	0.999928428094321, 0.999929643719887, 0.999930838699875, ...
	0.999932013384872, 0.999933168119513, 0.99993430324258, ...
	0.999935419087106, 0.99993651598047, 0.99993759424449, ...
	0.999938654195524, 0.999939696144558, 0.999940720397298, ...
	0.999941727254258, 0.999942717010853, 0.999943689957481, ...
	0.999944646379608, 0.999945586557858, 0.999946510768084, ...
	0.999947419281461, 0.999948312364556, 0.999949190279413, ...
	0.999950053283625, 0.999950901630411, 0.999951735568691, ...
	0.99995255534316, 0.999953361194357, 0.999954153358735, ...
	0.999954932068736, 0.999955697552851, 0.999956450035695, ...
	0.999957189738067, 0.999957916877017, 0.999958631665911, ...
	0.999959334314488, 0.999960025028931, 0.999960704011918, ...
	0.999961371462687, 0.999962027577092, 0.999962672547662, ...
	0.999963306563656, 0.999963929811121, 0.999964542472943, ...
	0.999965144728902, 0.999965736755727, 0.999966318727143, ...
	0.99996689081393, 0.999967453183963, 0.999968006002267, ...
	0.999968549431068, 0.999969083629833, 0.999969608755323, ...
	0.999970124961638, 0.999970632400259, 0.999971131220095, ...
	0.999971621567527, 0.99997210358645, 0.999972577418315, ...
	0.999973043202171, 0.999973501074706, 0.999973951170287, ...
	0.999974393620997, 0.999974828556678, 0.999975256104967, ...
	0.999975676391333, 0.999976089539113, 0.999976495669552, ...
	0.999976894901833, 0.999977287353118, 0.999977673138575, ...
	0.999978052371422, 0.999978425162949, 0.999978791622558, ...
	0.999979151857793, 0.999979505974373, 0.999979854076219, ...
	0.999980196265489, 0.999980532642604, 0.999980863306281, ...
	0.999981188353562, 0.999981507879837, 0.99998182197888, ...
	0.999982130742869, 0.99998243426242, 0.999982732626606, ...
	0.99998302592299, 0.999983314237648, 0.999983597655192, ...
	0.9999838762588, 0.999984150130234, 0.999984419349869, ...
	0.999984683996716, 0.999984944148443, 0.999985199881398, ...
	0.999985451270634, 0.999985698389928, 0.999985941311805, ...
	0.999986180107558, 0.999986414847268, 0.999986645599827, ...
	0.999986872432957, 0.999987095413228, 0.999987314606084, ...
	0.999987530075851, 0.999987741885768, 0.999987950097996, ...
	0.999988154773642, 0.999988355972777, 0.999988553754448, ...
	0.999988748176701, 0.999988939296597, 0.999989127170226, ...
	0.999989311852728, 0.999989493398302, 0.999989671860231, ...
	0.999989847290892, 0.999990019741769, 0.999990189263477, ...
	0.999990355905767, 0.999990519717547, 0.999990680746893, ...
	0.999990839041066, 0.999990994646524, 0.999991147608935, ...
	0.999991297973192, 0.999991445783426, 0.999991591083016, ...
	0.999991733914608, 0.99999187432012, 0.999992012340761, ...
	0.999992148017039, 0.999992281388773, 0.999992412495106, ...
	0.999992541374518, 0.999992668064833, 0.999992792603235, ...
	0.999992915026273, 0.999993035369879, 0.999993153669372, ...
	0.999993269959473, 0.999993384274311, 0.999993496647438, ...
	0.999993607111834, 0.99999371569992, 0.999993822443566, ...
	0.999993927374101, 0.99999403052232, 0.999994131918498, ...
	0.999994231592394, 0.999994329573261, 0.999994425889857, ...
	0.999994520570449, 0.999994613642827, 0.999994705134306, ...
	0.999994795071739, 0.999994883481523, 0.999994970389604, ...
	0.999995055821491, 0.999995139802257, 0.999995222356551, ...
	0.999995303508601, 0.999995383282226, 0.999995461700839, ...
	0.999995538787455, 0.9999956145647, 0.999995689054814, ...
	0.999995762279659, 0.999995834260726, 0.999995905019143, ...
	0.999995974575677, 0.999996042950741, 0.999996110164404, ...
	0.999996176236394, 0.999996241186102, 0.999996305032592, ...
	0.9999963677946, 0.999996429490549, 0.999996490138546, ...
	0.999996549756392, 0.999996608361583, 0.999996665971321, ...
	0.999996722602513, 0.999996778271783, 0.999996832995466, ...
	0.999996886789627, ], ...
                 numerictype(false, 14, 13), ...
                 fimath(x));
    end
    x_idx = fi((x - -4.4348)*58.3710345376449,1,16,5,fimath(x));
       idx_bot =  floor(x_idx) + 1;
       x_idx(:) = x_idx  + 1; 
       if ( idx_bot >= fi(1000,numerictype(idx_bot),fimath(x)) )
           idx_bot = fi((999),numerictype(idx_bot),fimath(x));
       elseif ( idx_bot < fi(1,numerictype(idx_bot),fimath(x)) )
           idx_bot = fi(1,numerictype(idx_bot),fimath(x));
       end
       idx_top = fi(idx_bot+1,numerictype(idx_bot),fimath(x));
       x_bot = idx_bot;
       x_top = idx_top;

       y_bot = LUT(idx_bot);
       y_top = LUT(idx_top);
        y = y_top*(x_idx-x_bot) + ...
            y_bot*(x_top - x_idx);
end

function fm = get_fimath()
	fm = fimath('RoundingMethod', 'Floor',...
	     'OverflowAction', 'Wrap',...
	     'ProductMode','FullPrecision',...
	     'MaxProductWordLength', 128,...
	     'SumMode','FullPrecision',...
	     'MaxSumWordLength', 128);
end
